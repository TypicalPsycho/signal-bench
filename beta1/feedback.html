<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SignalBench beta | Feedback</title>
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon/favicon-16x16.png" />
  <link rel="apple-touch-icon" href="icons/favicon/apple-touch-icon.png" />
  <link rel="manifest" href="icons/favicon/site.webmanifest" />
  <link rel="stylesheet" href="ui_shell.css" />
  <script src="ui_theme.js"></script>
  <script src="ui_store.js"></script>
  <style>
    .slider-row{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:center;}
    .slider-meta{font-size:13px; color:var(--muted); min-width:80px; text-align:right;}
    .slider-labels{display:flex; justify-content:space-between; font-size:12px; color:var(--muted);}
    .btn.mailto{font-size:14px; font-weight:600; line-height:1;}
  </style>
</head>
<body>
  <!--
    Integration Notes (Feedback)
    - Sliders submit only if touched
    - Optional detail fields (type, summary, situation, description, follow-up)
    - Submit to DataAdapter.submitFeedback(payload) or mailto fallback
  -->
  <div class="wrap">
    <div class="page">
                  <header class="page-header">
        <div class="brand large">
          <div class="brand-menu">
            <button class="brand-logo" type="button" aria-label="Open navigation">
              <img src="icons/logo1_round_80.png" alt="SignalBench logo" />
            </button>
            <div class="brand-panel" role="menu">

          <a href="landing.html" role="menuitem">Landing</a>
          <a href="auth.html" role="menuitem">Auth</a>
          <a href="onboarding.html" role="menuitem">Onboarding</a>
          <a href="casefile_new.html" role="menuitem">Casefile Setup</a>
          <a href="app.html" role="menuitem">App</a>
          <a href="settings.html" role="menuitem">Settings</a>
          <a href="feedback.html" role="menuitem">Feedback</a>
            </div>
          </div>
          <span class="brand-name">SignalBench</span>
        </div>
      </header>

      <main class="page-body">
        <section class="card">
          <h1 class="title">Slider feedback</h1>
          <p class="subtitle">Adjust one or more sliders below to share your impressions. Sliders you don’t adjust won’t be submitted.</p>

          <div class="field" style="margin-top:10px;">
            <span>System value</span>
            <div class="note">The system helps me think more clearly and effectively.</div>
            <div class="slider-row" style="margin-top:6px;">
              <input type="range" min="0" max="10" value="5" data-key="value" />
              <div class="slider-meta" id="meta-value">Not rated</div>
            </div>
            <div class="slider-labels">
              <span>Strongly Disagree</span>
              <span>Strongly Agree</span>
            </div>
          </div>

          <div class="field" style="margin-top:14px;">
            <span>System accuracy</span>
            <div class="note">The system's conclusions are well‑reasoned and helpful.</div>
            <div class="slider-row" style="margin-top:6px;">
              <input type="range" min="0" max="10" value="5" data-key="accuracy" />
              <div class="slider-meta" id="meta-accuracy">Not rated</div>
            </div>
            <div class="slider-labels">
              <span>Strongly Disagree</span>
              <span>Strongly Agree</span>
            </div>
          </div>

          <div class="field" style="margin-top:14px;">
            <span>System responsiveness</span>
            <div class="note">The system is responsive enough when I ask questions.</div>
            <div class="slider-row" style="margin-top:6px;">
              <input type="range" min="0" max="10" value="5" data-key="responsive" />
              <div class="slider-meta" id="meta-responsive">Not rated</div>
            </div>
            <div class="slider-labels">
              <span>Strongly Disagree</span>
              <span>Strongly Agree</span>
            </div>
          </div>

          <div class="field" style="margin-top:14px;">
            <span>System clarity</span>
            <div class="note">The system explains its reasoning in a way I can follow.</div>
            <div class="slider-row" style="margin-top:6px;">
              <input type="range" min="0" max="10" value="5" data-key="clarity" />
              <div class="slider-meta" id="meta-clarity">Not rated</div>
            </div>
            <div class="slider-labels">
              <span>Strongly Disagree</span>
              <span>Strongly Agree</span>
            </div>
          </div>
          <p class="note" style="margin-top:10px;">Note: the system’s tone and brevity can be adjusted in My Settings.</p>
        </section>

        <section class="card">
          <h2 class="title" style="font-size:22px;">Additional feedback (optional)</h2>
          <p class="subtitle">If you have feedback that benefits from explanation, use the fields below. If you’re only submitting slider feedback, you can scroll to the bottom and select Submit feedback without completing these fields.</p>

          <div class="field" style="margin-top:10px;">
            <span>What would you like to share?</span>
            <div class="row" style="flex-direction:column; margin-top:6px;">
              <label class="pill"><input type="radio" name="type" value="suggestion" /> Feedback / suggestion</label>
              <label class="pill"><input type="radio" name="type" value="bug" /> Something didn’t work as expected</label>
              <label class="pill"><input type="radio" name="type" value="question" /> Question / clarification</label>
              <label class="pill"><input type="radio" name="type" value="other" /> Other</label>
            </div>
          </div>

          <label class="field" style="margin-top:12px;">
            <span>Short summary</span>
            <input type="text" maxlength="100" placeholder="One sentence. What’s this about?" />
          </label>

          <label class="field" style="margin-top:12px;">
            <span>Situation</span>
            <textarea placeholder="What were you trying to do, on what screen, in what stage of the system."></textarea>
          </label>

          <label class="field" style="margin-top:12px;">
            <span>Description</span>
            <textarea placeholder="What happened, what you expected, or what you’re suggesting."></textarea>
          </label>

          <label class="field" style="margin-top:12px;">
            <span>Follow‑up</span>
            <label style="display:flex; gap:8px; align-items:center; margin-top:6px;">
              <input type="checkbox" id="followUp" checked />
              <span>You may contact me about this issue</span>
            </label>
          </label>
        </section>

        <section class="card">
          <div class="row">
            <button class="btn primary" id="btnSubmit" type="button">Submit feedback</button>
            <button class="btn" id="btnCancel" type="button">Do not submit</button>
            <a class="btn mailto" href="mailto:signal-bench@outlook.com?subject=Beta%20feedback%20on%20Signal-Bench%20from%20%5Busername%5D">Do not submit, send an email instead</a>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    const sliders = Array.from(document.querySelectorAll("input[type='range'][data-key]"));
    sliders.forEach((slider) => {
      slider.dataset.touched = "false";
      const meta = document.getElementById(`meta-${slider.dataset.key}`);
      const updateMeta = () => {
        slider.dataset.touched = "true";
        if (meta) meta.textContent = "Rated";
      };
      slider.addEventListener("input", updateMeta);
    });

    document.getElementById("btnSubmit").addEventListener("click", () => {
      const store = UIStore.load();
      const ratings = {};
      sliders.forEach((s) => {
        if (s.dataset.touched === "true") ratings[s.dataset.key] = Number(s.value);
      });
      const payload = {
        ratings,
        type: document.querySelector("input[name='type']:checked")?.value || "",
        summary: document.querySelector("input[type='text']")?.value.trim() || "",
        situation: document.querySelectorAll("textarea")[0]?.value.trim() || "",
        description: document.querySelectorAll("textarea")[1]?.value.trim() || "",
        followUp: document.getElementById("followUp")?.checked || false,
        createdAt: new Date().toISOString()
      };
      store.feedback = store.feedback || [];
      store.feedback.push(payload);
      UIStore.save(store);
      alert("Feedback submitted (demo).");
    });
    document.getElementById("btnCancel").addEventListener("click", () => {
      alert("Feedback not submitted");
    });
  </script>


  <script>
    document.querySelectorAll(".brand-menu").forEach((menu) => {
      const trigger = menu.querySelector(".brand-logo");
      if (!trigger) return;
      trigger.addEventListener("click", (e) => {
        e.preventDefault();
        e.stopPropagation();
        menu.classList.toggle("open");
      });
    });
    document.addEventListener("click", (e) => {
      document.querySelectorAll(".brand-menu.open").forEach((menu) => {
        if (!menu.contains(e.target)) menu.classList.remove("open");
      });
    });
  </script>
</body>
</html>
